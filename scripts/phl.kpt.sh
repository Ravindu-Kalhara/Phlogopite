#!/bin/bash

####################################################

NAME='kpt'

####################################################

for KPTBC in 1 2 3 4 5
do
KPTA=$((KPTBC * 2))
cat > ./test_files/phl.${NAME}_${KPTBC}.in << EOF
 &CONTROL
   calculation     = 'scf' 
   outdir          = './test_files/temp/' 
   pseudo_dir      = './../../pseudos/' 
   prefix          = 'phl' 
   verbosity       = 'high' 
 /
 &SYSTEM
   ibrav           = -12
   A               = 5.29899 
   B               = 9.19537 
   C               = 10.20856 
   cosAC           = -0.17756524 
   nat             = 44
   ntyp            = 6
   ecutwfc         = 45 
   ecutrho         = 360 
   vdw_corr        = 'grimme-d3' 
 /
 &ELECTRONS
 /
ATOMIC_SPECIES
   Al   26.98154  Al.pbe-n-kjpaw_psl.1.0.0.UPF 
    H    1.00794  H.pbe-kjpaw_psl.1.0.0.UPF 
    K   39.09830  K.pbe-spn-kjpaw_psl.1.0.0.UPF 
   Mg   24.30500  Mg.pbe-spnl-kjpaw_psl.1.0.0.UPF 
    O   15.99940  O.pbe-n-kjpaw_psl.1.0.0.UPF 
   Si   28.08550  Si.pbe-n-kjpaw_psl.1.0.0.UPF 
ATOMIC_POSITIONS crystal 
    K      0.000000000    0.493239999    0.000000000    
    K      0.500000000    0.005392000    0.000000000    
   Mg      0.000000000    0.003902000    0.500000000    
   Mg      0.000000000    0.333130985    0.500000000    
   Mg      0.000000000    0.665235996    0.500000000    
   Mg      0.500000000    0.493413001    0.500000000    
   Mg      0.500000000    0.834439993    0.500000000    
   Mg      0.500000000    0.172095001    0.500000000    
   Si      0.082799003    0.165114999    0.222553998    
   Si      0.917200983    0.165114999    0.777446032    
   Si      0.934085011    0.834244013    0.771593988    
   Si      0.065914989    0.834244013    0.228406012    
   Si      0.564658999    0.666652024    0.226418003    
   Si      0.435341001    0.666652024    0.773581982    
   Al      0.416085005    0.331167012    0.776085973    
   Al      0.583914995    0.331167012    0.223914027    
    O      0.127317995    0.163298994    0.384905010    
    O      0.872681975    0.163298994    0.615095019    
    O      0.874698997    0.832777023    0.610629976    
    O      0.125301003    0.832777023    0.389370024    
    O      0.625379980    0.669556975    0.388085008    
    O      0.374620020    0.669556975    0.611914992    
    O      0.361501992    0.333070010    0.604161024    
    O      0.638498008    0.333070010    0.395838976    
    O      0.341459990    0.204509005    0.165809005    
    O      0.658540010    0.204509005    0.834190965    
    O      0.997898996    0.997125983    0.167799994    
    O      0.002101004    0.997125983    0.832199991    
    O      0.683152020    0.774465978    0.830969989    
    O      0.316847980    0.774465978    0.169030011    
    O      0.815735996    0.732487023    0.168000996    
    O      0.184264004    0.732487023    0.831999004    
    O      0.498916000    0.507770002    0.162765995    
    O      0.501083970    0.507770002    0.837234020    
    O      0.145023003    0.275602996    0.839995027    
    O      0.854977012    0.275602996    0.160004973    
    O      0.130662993    0.504248023    0.393970013    
    O      0.869337022    0.504248023    0.606029987    
    O      0.632564008    0.999011993    0.397415012    
    O      0.367435992    0.999011993    0.602584958    
    H      0.099151999    0.495819986    0.299232006    
    H      0.900848031    0.495819986    0.700767994    
    H      0.596361995    0.012651000    0.303090990    
    H      0.403638005    0.012651000    0.696909010    
K_POINTS automatic 
  ${KPTA} ${KPTBC} ${KPTBC}   0 0 0 

EOF

mpirun -np 6 pw.x < ./test_files/phl.${NAME}_${KPTBC}.in >  ./test_files/phl.${NAME}_${KPTBC}.out
echo ${NAME}=${KPTBC} done

done

